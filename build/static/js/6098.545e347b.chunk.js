"use strict";(self.webpackChunkfuse_react_app=self.webpackChunkfuse_react_app||[]).push([[6098],{66098:function(e,n,t){t.r(n),t.d(n,{default:function(){return M}});var r=t(1413),a=t(29439),i=t(52452),s=t(41930),c=t(93938),o=t(54696),u=t(96763),l=t(35477),d=t(95209),p=t(5019),f=t(50390),m=t(4743),x=t(10361),h=t(1314),Z=t(18369),v=t(33383),g=t(49360),j=t(94001),z=t(30823),y=t(63787),w=t(74165),b=t(15861),k=t(88669),P=t(82360),S=t(93693),C=(t(78449),t(31588)),A=t(34758),N=t(14476),_=t(62586),E=t(41627),I=t(62559);var B=function(e){var n=e.params,t=(0,m.I0)(),r=(0,Z.Gc)(),i=r.formState,c=r.watch,o=r.getValues,u=i.isValid,v=i.dirtyFields,g=(0,k.Z)(),j=(0,x.s0)(),y=c("img"),B=(0,f.useState)({msg:"",alert:""}),D=(0,a.Z)(B,2),O=D[0],T=D[1],V=(0,f.useState)(!1),R=(0,a.Z)(V,2),U=R[0],F=R[1],W=(0,f.useState)(),M=(0,a.Z)(W,2),q=(M[0],M[1]),Q=(0,x.UO)().prizeId,G=((0,C.cF)(),(0,m.v9)(A.dy),(0,f.useState)(!1)),K=(0,a.Z)(G,2),J=K[0],H=K[1],L=function(){var e=(0,b.Z)((0,w.Z)().mark((function e(){var n,r;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=o(),console.log("data a guardar: ",n),n.category="PRODUCTO",n.description=n.sku.description,n.img=n.sku.image,n.sku=n.sku.sku,""===n.sku||""===n.category||""===n.points?T({msg:"Existen campos vac\xedos",alert:!1}):"new"===Q?(console.log("data",n),t((0,z.WQ)(n)).then((function(){j("/prizes")}))):((r=Object.fromEntries(Object.entries(n).filter((function(e){return"updated_at"!==e[0]})))).points=parseInt(r.points,10),t((0,z.Tr)(r)).then((function(e){"fulfilled"===e.meta.requestStatus&&j("/prizes"),"rejected"===e.meta.requestStatus&&T(!1),H(!1)})));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,f.useEffect)((function(){if(void 0!==(null===y||void 0===y?void 0:y.name)){var e=new FileReader;e.addEventListener("load",(function(){q(e.result)})),e.readAsDataURL(y)}else q(y)}),[y]),(0,I.jsxs)("div",{className:"flex flex-col flex-1 w-full ",children:[(0,I.jsxs)("div",{className:"flex flex-col sm:flex-row flex-1 w-full items-center justify-between space-y-8 sm:space-y-0 py-32 px-24 md:px-32",children:[(0,I.jsxs)("div",{className:"flex flex-col items-center sm:items-start space-y-8 sm:space-y-0 w-full sm:max-w-full min-w-0",children:[(0,I.jsx)(d.E.div,{initial:{x:20,opacity:0},animate:{x:0,opacity:1,transition:{delay:.3}},children:(0,I.jsxs)(l.Z,{className:"flex items-center sm:mb-12",component:h.rU,role:"button",to:"/prizes",color:"inherit",children:[(0,I.jsx)(P.Z,{size:20,children:"ltr"===g.direction?"heroicons-outline:arrow-sm-left":"heroicons-outline:arrow-sm-right"}),(0,I.jsx)("span",{className:"flex mx-4 font-medium",children:"Premios"})]})}),(0,I.jsx)("div",{className:"flex max-w-full",children:(0,I.jsxs)(d.E.div,{className:"flex flex-col items-center sm:items-start min-w-0 mx-8 sm:mx-16",initial:{x:-20},animate:{x:0,transition:{delay:.3}},children:[(0,I.jsx)(l.Z,{className:"text-16 sm:text-20 truncate font-semibold",children:"new"===n?"Nuevo Premio":"update"===n?"Actualizar Premio":"Vista de Premio"}),(0,I.jsx)(l.Z,{variant:"caption",className:"font-medium",children:"Detalle del premio"})]})})]}),"view"!==Q&&(0,I.jsxs)(d.E.div,{className:"flex",initial:{opacity:0,x:20},animate:{opacity:1,x:0,transition:{delay:.3}},children:[(0,I.jsx)(p.Z,{className:"whitespace-nowrap mx-4",variant:"contained",color:"secondary",onClick:function(){F(!0)},startIcon:(0,I.jsx)(P.Z,{className:"hidden sm:flex",children:"heroicons-outline:trash"}),children:"Eliminar"}),(0,I.jsx)(E.Z,{open:U,title:"Confirmar Eliminaci\xf3n",message:"\xbfEst\xe1s seguro de que deseas eliminar este Premio?",onCancel:function(){F(!1)},onConfirm:function(){var e=o();t((0,z.Fb)(e.id)).then((function(){j("/prizes")})),F(!1)}}),(0,I.jsx)(N.Z,{color:"secondary",onClick:function(){L(),H(!0)},loading:J,loadingPosition:"start",startIcon:(0,I.jsx)(_.Z,{}),variant:"contained",disabled:"new"===Q?s.Z.isEmpty(v)||!u:null,children:(0,I.jsx)("span",{children:"Guardar"})})]})]}),O.alert&&(0,I.jsx)(S.Z,{severity:"success",children:"Los datos se guardaron correctamente"}),!1===O.alert?(0,I.jsx)(S.Z,{severity:"error",children:O.msg}):null]})},D=t(12066),O=t(25594),T=t(43965),V=t(31680),R=t(98884),U=(t(60606),t(7493));var F=function(e){var n=e.params,t=(0,Z.Gc)(),i=t.control,s=t.formState,c=(t.setValue,s.errors),o=(0,m.I0)(),u=(0,f.useState)(),d=(0,a.Z)(u,2),p=d[0],x=d[1],h=(0,f.useState)(),v=(0,a.Z)(h,2),g=v[0],j=v[1],z=(0,f.useState)([]),y=(0,a.Z)(z,2),w=y[0],b=y[1],k=(0,f.useState)(w),P=(0,a.Z)(k,2),S=P[0],C=P[1],A=(0,f.useState)([]),N=(0,a.Z)(A,2),_=(N[0],N[1]),E=i._formValues,B=(E.id,E.title,E.category,E.img),F=(E.channel,E.gec),W=E.description;E.sku,E.points,E.status,console.log("params",i._formValues);var M=(0,f.useState)(null),q=(0,a.Z)(M,2),Q=(q[0],q[1],(0,f.useState)({})),G=(0,a.Z)(Q,2),K=G[0],J=G[1];return(0,f.useEffect)((function(){o((0,R.vp)()).then((function(e){_(e.payload.sort((function(e,n){return e.brand.localeCompare(n.brand)})))})),o((0,R.Xp)()).then((function(e){b(e.payload.sort((function(e,n){return e.sku>n.sku?1:-1}))),C(e.payload.sort((function(e,n){return e.sku>n.sku?1:-1})))})),o((0,R.ng)()).then((function(e){x(e.payload.channels)}))}),[o]),(0,f.useEffect)((function(){if(i._formValues.channel&&p.length>=1){var e=p.find((function(e){return e.canal===i._formValues.channel}));console.log("gec",F),j(e.gec)}}),[p]),(0,I.jsxs)("div",{className:"ml-10",children:[(0,I.jsxs)(O.ZP,{container:!0,padding:5,rowSpacing:2,columnSpacing:{xs:1,sm:1,md:3},children:[(0,I.jsxs)(O.ZP,{item:!0,xs:6,md:4,children:[(0,I.jsx)(l.Z,{className:"text-16 sm:text-14 truncate font-semibold",children:"Categoria"}),(0,I.jsx)(Z.Qr,{name:"category",control:i,render:function(e){var n=e.field;return(0,I.jsx)(T.Z,(0,r.Z)((0,r.Z)({},n),{},{id:"category",value:n.value||"PRODUCTO",variant:"outlined",fullWidth:!0,children:(0,I.jsx)(V.Z,{value:"PRODUCTO",children:" Producto"})}))}})]}),(0,I.jsxs)(O.ZP,{item:!0,xs:4,md:4,children:[(0,I.jsx)(l.Z,{className:"text-16 sm:text-14 truncate font-semibold",children:"Canal"}),(0,I.jsx)(Z.Qr,{name:"channel",control:i,render:function(e){var n=e.field;return(0,I.jsxs)(T.Z,(0,r.Z)((0,r.Z)({},n),{},{id:"channel",value:n.value||"0",variant:"outlined",fullWidth:!0,onChange:function(e){var t=e.target.value;n.onChange(t),function(e){var n=p.find((function(n){return n.canal===e.target.value}));j(n.gec)}(e)},children:[(0,I.jsx)(V.Z,{value:"0",children:" Seleccione un Canal"}),null===p||void 0===p?void 0:p.map((function(e,n){return(0,I.jsxs)(V.Z,{value:e.canal,children:[" ",e.canal]},n)}))]}))}})]}),(0,I.jsxs)(O.ZP,{item:!0,xs:4,md:4,children:[(0,I.jsx)(l.Z,{className:"text-16 sm:text-14 truncate font-semibold",children:"GEC"}),(0,I.jsx)(Z.Qr,{name:"gec",control:i,render:function(e){var n=e.field;return(0,I.jsxs)(T.Z,(0,r.Z)((0,r.Z)({},n),{},{id:"gec",value:n.value||"0",variant:"outlined",fullWidth:!0,children:[(0,I.jsx)(V.Z,{value:"0",children:" Seleccione un GEC"}),null===g||void 0===g?void 0:g.map((function(e,n){return(0,I.jsxs)(V.Z,{value:e,children:[" ",e]},n)}))]}))}})]})]}),(0,I.jsxs)(O.ZP,{container:!0,padding:5,rowSpacing:2,columnSpacing:{xs:1,sm:1,md:3},children:[(0,I.jsxs)(O.ZP,{item:!0,xs:4,md:4,children:[(0,I.jsx)(l.Z,{className:"text-16 sm:text-14 truncate font-semibold",children:"SKU"}),(0,I.jsx)(Z.Qr,{name:"sku",control:i,render:function(e){var n=e.field;return(0,I.jsx)(U.Z,{disablePortal:!0,id:"combo-box-demo",value:n.value||null,options:S,onChange:function(e,t){var r;n.onChange(t),r=t,console.log("eeeeeee",r),J({img:r.image,description:r.description,brand:r.brand,size:r.size})},getOptionLabel:function(e){if(e&&e.sku&&e.description)return"".concat(e.sku," - ").concat(e.description);if("string"!==typeof n.value){var t=S.find((function(e){return e.sku===n.value}));if(t&&t.sku&&t.description)return"".concat(t.sku," - ").concat(t.description)}return""},renderInput:function(e){return(0,I.jsx)(D.Z,(0,r.Z)({placeholder:"Buscar SKU"},e))}})}})]}),(0,I.jsxs)(O.ZP,{item:!0,xs:6,md:4,children:[(0,I.jsx)(l.Z,{className:"text-12 sm:text-14 truncate font-semibold",children:"Descripcion"}),(0,I.jsx)(D.Z,{fullWidth:!0,value:K.description||W,disabled:!0})]}),(0,I.jsxs)(O.ZP,{item:!0,xs:4,md:4,children:[(0,I.jsx)(l.Z,{className:"text-16 sm:text-14 truncate font-semibold",children:"Imagen"}),(0,I.jsx)("img",{style:{position:"absolute",textAlign:"center"},src:K.img||B})]})]}),(0,I.jsx)(O.ZP,{container:!0,padding:5,rowSpacing:2,columnSpacing:{xs:1,sm:1,md:3},children:(0,I.jsxs)(O.ZP,{item:!0,xs:6,md:4,children:[(0,I.jsx)(l.Z,{className:"text-12 sm:text-14 truncate font-semibold",children:"Puntos Requeridos"}),(0,I.jsx)(Z.Qr,{name:"points",control:i,render:function(e){var t,a=e.field;return(0,I.jsx)(D.Z,(0,r.Z)((0,r.Z)({className:"mt-8 mb-16",required:!0,error:!!c.points,helperText:null===c||void 0===c||null===(t=c.points)||void 0===t?void 0:t.message},a),{},{value:a.value||"",placeholder:"Ingrese Puntos",id:"points",variant:"outlined",fullWidth:!0,disabled:"view"===n,onChange:function(e){var n=parseInt(e.target.value);a.onChange(n)},inputProps:{inputMode:"numeric",pattern:"[0-9]*"}}))}})]})})]})},W=g.Ry().shape({sku:g.Ry().required("Debe ingresar un Titulo"),points:g.Z_().required("Debe ingresar una Descripcion")});var M=(0,o.Z)("prizesApp",y.Z)((function(e){var n=(0,m.I0)(),t=(0,m.v9)(z.h6),o=(0,j.Z)((function(e){return e.breakpoints.down("lg")})),g=(0,x.UO)(),y=(0,f.useState)(!1),w=(0,a.Z)(y,2),b=w[0],k=w[1],P=(0,Z.cI)({mode:"onChange",defaultValues:{sku:null,points:null},resolver:(0,v.X)(W)}),S=P.reset,C=P.watch,A=(P.control,P.onChange,P.formState,C()),N=(0,x.TH)();return(0,u.KW)((function(){!function(){var e=g.prizeId;n("new"===e?(0,z.pj)():(0,z.JW)(N.state))}()}),[n,g,N]),(0,f.useEffect)((function(){t&&S(t)}),[t,S]),(0,f.useEffect)((function(){return function(){n((0,z.n8)()),k(!1)}}),[n]),b?(0,I.jsxs)(d.E.div,{initial:{opacity:0},animate:{opacity:1,transition:{delay:.1}},className:"flex flex-col flex-1 items-center justify-center h-full",children:[(0,I.jsx)(l.Z,{color:"text.secondary",variant:"h5",children:"No hay Competencias"}),(0,I.jsx)(p.Z,{className:"mt-24",component:h.rU,variant:"outlined",to:"/prizes",color:"inherit",children:"Volver a Competencias"})]}):s.Z.isEmpty(A)||t&&g.prizeId!==t.id&&"new"!==g.prizeId&&"update"!==g.prizeId&&"view"!==g.prizeId?(0,I.jsx)(i.Z,{}):(0,I.jsx)(Z.RV,(0,r.Z)((0,r.Z)({},P),{},{children:(0,I.jsx)(c.Z,{header:(0,I.jsx)(B,{params:g.prizeId}),content:(0,I.jsx)(F,{params:g.prizeId}),scroll:o?"normal":"content"})}))}))},63787:function(e,n,t){var r=t(48028),a=t(98884),i=t(30823),s=(0,r.UY)({prizes:a.ZP,prize:i.ZP});n.Z=s},30823:function(e,n,t){t.d(n,{Fb:function(){return m},JW:function(){return g},Tr:function(){return f},WQ:function(){return p},h6:function(){return j},n8:function(){return Z},pj:function(){return v}});var r,a=t(4942),i=t(74165),s=t(1413),c=t(15861),o=t(97744),u=t(45133),l=t.n(u),d=t(90326),p=(0,o.hg)("prizesApp/prize/addPrize",function(){var e=(0,c.Z)((0,i.Z)().mark((function e(n,t){var r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.getState,console.log("prizeData a guardar",n),e.next=4,l().post(d._n+d.pc+"/back/catalogs",(0,s.Z)({},n),{headers:{Authorization:d.o3}});case 4:return r=e.sent,e.next=7,r.data;case 7:return a=e.sent,console.log("dataaaaaa",a),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),f=(0,o.hg)("prizesApp/prize/updatePrize",function(){var e=(0,c.Z)((0,i.Z)().mark((function e(n,t){var r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.getState,console.log("prizeData",n),e.next=4,l().put(d._n+d.pc+"/back/catalogs",(0,s.Z)({},n),{headers:{Authorization:d.o3}});case 4:return r=e.sent,e.next=7,r.data;case 7:return a=e.sent,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),m=(0,o.hg)("prizesApp/prize/removePrize",function(){var e=(0,c.Z)((0,i.Z)().mark((function e(n,t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch,t.getState,console.log("deleteeeeeee",n),e.next=4,l().delete(d._n+d.pc+"/back/catalogs/".concat(n),{headers:{Authorization:d.o3}});case 4:return e.abrupt("return",id);case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()),x=(0,o.oM)({name:"prizesApp/prize",initialState:{prize:{sku:null,points:null}},reducers:{resetPrize:function(){return null},newPrize:{reducer:function(e,n){return n.payload},prepare:function(e){return{payload:{sku:null,points:null}}}},setPrize:{reducer:function(e,n){return n.payload}}},extraReducers:(r={},(0,a.Z)(r,p.fulfilled,(function(e,n){return n.payload})),(0,a.Z)(r,f.fulfilled,(function(e,n){return n.payload})),(0,a.Z)(r,m.fulfilled,(function(e,n){return n.payload})),r)}),h=x.actions,Z=h.resetPrize,v=h.newPrize,g=h.setPrize,j=function(e){return e.prizesApp.prize};n.ZP=x.reducer},98884:function(e,n,t){t.d(n,{BB:function(){return j},FJ:function(){return g},Xp:function(){return m},ii:function(){return Z},lz:function(){return d},ng:function(){return p},vp:function(){return f}});var r,a=t(4942),i=t(74165),s=t(15861),c=t(97744),o=t(45133),u=t.n(o),l=t(90326),d=(0,c.hg)("prizesApp/getPrizes",(0,s.Z)((0,i.Z)().mark((function e(){var n,t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u().get(l._n+l.pc+"/back/catalogs",{headers:{Authorization:l.o3}});case 2:return n=e.sent,e.next=5,n.data;case 5:return(t=e.sent).reverse(),e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})))),p=(0,c.hg)("prizesApp/getVariables",(0,s.Z)((0,i.Z)().mark((function e(){var n,t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u().get(l._n+l.pc+"/back/variables",{headers:{Authorization:l.o3}});case 2:return n=e.sent,e.next=5,n.data;case 5:return t=e.sent,e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})))),f=(0,c.hg)("misionsApp/getBrands",(0,s.Z)((0,i.Z)().mark((function e(){var n,t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u().get(l._n+l.pc+"/back/brands",{headers:{Authorization:l.o3}});case 2:return n=e.sent,e.next=5,n.data;case 5:return t=e.sent,e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})))),m=(0,c.hg)("misionsApp/getProducts",(0,s.Z)((0,i.Z)().mark((function e(){var n,t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u().get(l._n+l.pc+"/back/products",{headers:{Authorization:l.o3}});case 2:return n=e.sent,e.next=5,n.data;case 5:return t=e.sent,e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})))),x=(0,c.HF)({}),h=x.getSelectors((function(e){return e.prizesApp.prizes})),Z=h.selectAll,v=(h.selectById,(0,c.oM)({name:"prizesApp",initialState:x.getInitialState({searchText:"",variables:[]}),reducers:{setPrizesSearchText:{reducer:function(e,n){e.searchText=n.payload},prepare:function(e){return{payload:e.target.value||""}}}},extraReducers:(r={},(0,a.Z)(r,d.fulfilled,x.setAll),(0,a.Z)(r,p.fulfilled,(function(e,n){e.variables=n.payload})),r)})),g=v.actions.setPrizesSearchText,j=function(e){return e.prizesApp.prizes.searchText};n.ZP=v.reducer},41627:function(e,n,t){t(50390);var r=t(54982),a=t(78426),i=t(93085),s=t(7887),c=t(5019),o=t(62559);n.Z=function(e){var n=e.open,t=e.title,u=e.message,l=e.onCancel,d=e.onConfirm;return(0,o.jsxs)(r.Z,{open:n,onClose:l,children:[(0,o.jsx)(a.Z,{children:t}),(0,o.jsx)(i.Z,{children:u}),(0,o.jsxs)(s.Z,{children:[(0,o.jsx)(c.Z,{onClick:l,children:"Cancelar"}),(0,o.jsx)(c.Z,{onClick:d,color:"error",children:"Eliminar"})]})]})}},78449:function(e,n,t){t.d(n,{DB:function(){return o},ni:function(){return u},sS:function(){return l},wf:function(){return c}});var r=t(74165),a=t(15861),i=t(31588),s=t(26759),c=function(){var e=new Date,n=e.getFullYear(),t=e.getMonth()+1;return[e.getDate(),t,n].join("_")},o=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object.entries(n).map(function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var a,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("img_brief"!==t[0]&&"img_description"!==t[0]||!t[1].name){e.next=8;break}return a=c(),o=(0,i.iH)(s.tO,"coupons/".concat(t[1].name+"_"+a)),e.next=5,(0,i.KV)(o,t[1]);case 5:return e.next=7,(0,i.Jt)(o);case 7:n[t[0]]=e.sent;case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),u=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,t){var a,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.name){e.next=8;break}return a=c(),o=(0,i.iH)(s.tO,"sliders/".concat(t.name+"_"+a)),e.next=5,(0,i.KV)(o,t);case 5:return e.next=7,(0,i.Jt)(o);case 7:n.image=e.sent;case 8:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),l=function(e,n){if(0==e)return"0 Bytes";var t=n||2,r=Math.floor(Math.log(e)/Math.log(1e3));return parseFloat((e/Math.pow(1e3,r)).toFixed(t))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}}}]);
//# sourceMappingURL=6098.545e347b.chunk.js.map